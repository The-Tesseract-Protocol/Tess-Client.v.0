{"version":3,"sources":["../../../../app/batch-payments/page.tsx","../../../../app/services/bulkPaymentService.ts","../../../../app/batch-payments/components/RecipientsInput.tsx","../../../../app/batch-payments/components/AuthTreeVisualization.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useMemo, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { lexendTera } from '../components/Fonts';\nimport RecipientsInput, { Recipient } from './components/RecipientsInput';\nimport AuthTreeVisualization from './components/AuthTreeVisualization';\nimport { SAFE_LIMITS, BulkPaymentService, PaymentRecipient } from '../services/bulkPaymentService';\nimport { WalletProvider, useWallet, ConnectWalletButton, NetworkBadge } from '../contexts/WalletContext';\nimport { isWalletError, WalletErrorCode } from '../services/walletService';\nimport IsoLevelWarp from '../components/ui/isometric-ui';\n\ntype TransactionState = 'idle' | 'preparing' | 'signing' | 'submitting' | 'success' | 'error';\n\ninterface TransactionStatus {\n    state: TransactionState;\n    message: string;\n    hash?: string;\n    error?: string | React.ReactNode;\n}\n\nfunction BatchPaymentsContent() {\n    const router = useRouter();\n    const { walletState, signAuthEntry, formatAddress, isTestnet } = useWallet();\n\n    const [recipients, setRecipients] = useState<Recipient[]>([\n        { id: '1', address: '', amount: '', isValid: false },\n    ]);\n    const [txStatus, setTxStatus] = useState<TransactionStatus>({\n        state: 'idle',\n        message: 'Ready to process payments',\n    });\n\n    // NEW: Track if visualization animation has completed\n    const [isVisualizationComplete, setIsVisualizationComplete] = useState(false);\n\n    // Callback when visualization finishes its completion animation\n    const handleVisualizationComplete = useCallback(() => {\n        setIsVisualizationComplete(true);\n    }, []);\n\n    // Compute valid recipients and batches\n    const validRecipients = useMemo(() => recipients.filter((r) => r.isValid), [recipients]);\n\n    const batchInfo = useMemo(() => {\n        const count = validRecipients.length;\n        if (count === 0) return [];\n\n        const batches = [];\n        for (let i = 0; i < count; i += SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH) {\n            batches.push({\n                workerIndex: batches.length,\n                recipientCount: Math.min(SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH, count - i),\n            });\n        }\n        return batches;\n    }, [validRecipients]);\n\n    const totalAmount = useMemo(() => {\n        return validRecipients.reduce((sum, r) => sum + parseFloat(r.amount), 0);\n    }, [validRecipients]);\n\n    // Execute batch payment\n    const executeBatchPayment = async () => {\n        // Reset visualization state for new transaction\n        setIsVisualizationComplete(false);\n\n        if (validRecipients.length === 0) {\n            setTxStatus({\n                state: 'error',\n                message: 'No valid recipients',\n                error: 'Add at least one valid recipient',\n            });\n            return;\n        }\n\n        if (!walletState.isConnected || !walletState.address) {\n            setTxStatus({\n                state: 'error',\n                message: 'Wallet not connected',\n                error: 'Please connect your Freighter wallet first',\n            });\n            return;\n        }\n\n        // Check network\n        if (!isTestnet()) {\n            setTxStatus({\n                state: 'error',\n                message: 'Wrong network',\n                error: 'Please switch to Stellar Testnet in Freighter',\n            });\n            return;\n        }\n\n        try {\n            setTxStatus({ state: 'preparing', message: 'Building authorization tree...' });\n\n            // Initialize the bulk payment service\n            const bulkPaymentService = new BulkPaymentService('testnet');\n\n            // Check if user account exists\n            const accountCheck = await bulkPaymentService.checkAccountExists(walletState.address);\n            if (!accountCheck.exists) {\n                setTxStatus({\n                    state: 'error',\n                    message: 'Account not funded',\n                    error: (\n                        <span>\n                            Your wallet address does not exist on Stellar Testnet. Please fund it using the Stellar{' '}\n                            <a\n                                href={`https://friendbot.stellar.org?addr=${walletState.address}`}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"underline hover:text-blue-300\"\n                            >\n                                Friendbot\n                            </a>\n                            .\n                        </span>\n                    ),\n                });\n                return;\n            }\n\n            // Convert recipients to PaymentRecipient format\n            const paymentRecipients: PaymentRecipient[] = validRecipients.map((r) => ({\n                address: r.address,\n                amount: BulkPaymentService.xlmToStroops(r.amount),\n            }));\n\n            // Validate and create batches\n            const batchResult = bulkPaymentService.validateAndCreateBatches(paymentRecipients);\n\n            if (batchResult.error || !batchResult.batches) {\n                setTxStatus({\n                    state: 'error',\n                    message: 'Validation failed',\n                    error: batchResult.error || 'Failed to create batches',\n                });\n                return;\n            }\n\n            // Build the authorization tree\n            const authTreeResult = await bulkPaymentService.buildAuthTree(\n                walletState.address,\n                batchResult.batches\n            );\n\n            setTxStatus({ state: 'signing', message: 'Awaiting wallet signature...' });\n\n            // Sign with Freighter using the preimage XDR (Freighter hashes it internally)\n            // Freighter returns the signature (signed hash), not a full auth entry\n            const signResult = await signAuthEntry(authTreeResult.authPreimageXdr);\n\n            if (isWalletError(signResult)) {\n                if (signResult.code === WalletErrorCode.USER_REJECTED) {\n                    setTxStatus({\n                        state: 'error',\n                        message: 'Signing cancelled',\n                        error: 'You cancelled the signing request',\n                    });\n                } else {\n                    setTxStatus({\n                        state: 'error',\n                        message: 'Signing failed',\n                        error: signResult.message,\n                    });\n                }\n                return;\n            }\n\n            setTxStatus({ state: 'submitting', message: 'Attaching signature and submitting...' });\n\n            // Freighter returns the signature as base64 - decode it\n            // Use atob for browser compatibility, then convert to Buffer for the SDK\n            const binaryString = atob(signResult.signedAuthEntry);\n            const signatureBytes = new Uint8Array(binaryString.length);\n            for (let i = 0; i < binaryString.length; i++) {\n                signatureBytes[i] = binaryString.charCodeAt(i);\n            }\n            const signatureBuffer = Buffer.from(signatureBytes);\n\n            // Attach the signature to the auth entry\n            const signedAuthEntry = await bulkPaymentService.signAuthEntry(\n                authTreeResult.authEntry,\n                walletState.address,\n                async () => signatureBuffer, // Return the signature we already have\n                authTreeResult.authPayload\n            );\n\n            // Get service account secret key from environment\n            // ⚠️ WARNING: This is insecure and only for testnet/development\n            const serviceSecretKey = process.env.NEXT_PUBLIC_SERVICE_SECRET_KEY;\n\n            if (!serviceSecretKey) {\n                setTxStatus({\n                    state: 'error',\n                    message: 'Configuration error',\n                    error: 'Service account key not configured. Set NEXT_PUBLIC_SERVICE_SECRET_KEY in .env.local',\n                });\n                return;\n            }\n\n            // Submit the transaction to the network\n            const txResult = await bulkPaymentService.submitTransaction(\n                signedAuthEntry,\n                serviceSecretKey\n            );\n\n            if (txResult.success) {\n                setTxStatus({\n                    state: 'success',\n                    message: `Payment successful! ${batchResult.stats?.totalRecipients} recipients paid.`,\n                    hash: txResult.hash,\n                });\n            } else {\n                setTxStatus({\n                    state: 'error',\n                    message: 'Transaction failed',\n                    error: txResult.error || 'Unknown error during submission',\n                });\n            }\n\n        } catch (error: any) {\n            console.error('Batch payment error:', error);\n            setTxStatus({\n                state: 'error',\n                message: 'Transaction failed',\n                error: error.message || 'Unknown error occurred',\n            });\n        }\n    };\n\n    // Reset transaction\n    const resetTransaction = () => {\n        setTxStatus({ state: 'idle', message: 'Ready to process payments' });\n        setIsVisualizationComplete(false);\n    };\n\n    // Determine if actively processing (transaction in progress OR waiting for visualization to complete)\n    const isTransactionInProgress = ['preparing', 'signing', 'submitting'].includes(txStatus.state);\n\n    // Button shows loading until BOTH transaction completes AND visualization animation finishes\n    // This ensures synchronized completion experience\n    const isProcessing = isTransactionInProgress ||\n        (txStatus.state === 'success' );\n\n    const canSubmit = validRecipients.length > 0 && walletState.isConnected && !isProcessing;\n\n    return (\n        <div className=\"min-h-screen text-white font-mono\">\n            <IsoLevelWarp \n        // Cyber-Violet Color\n        color=\"100, 50, 250\" \n        density={50} \n        speed={1.5}\n      />\n            {/* Navigation */}\n            <nav className=\"w-full flex items-center justify-between py-6 px-8 lg:px-16 fixed top-0 left-0 z-50 bg-black/80 backdrop-blur-lg border-b border-white/5\">\n                <div className=\"flex items-center gap-x-4\">\n                    <button\n                        onClick={() => router.push('/dashboard')}\n                        className=\"flex items-center gap-2 text-white/60 hover:text-white transition-colors\"\n                    >\n                        <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                        </svg>\n                        Back\n                    </button>\n                    <div className=\"w-px h-6 bg-white/20 font-mono\" />\n                    <a href=\"/\" className=\"text-white/80 hover:text-white transition-colors flex items-center\">\n                        <img src=\"/Tess_BW.svg\" alt=\"Tesseract\" className=\"h-7 w-7 inline-block mr-2\" />\n                        <span className=\"hidden sm:inline font-mono\">TESSERACT</span>\n                    </a>\n                </div>\n\n                {/* Wallet Connection */}\n                <div className=\"flex items-center gap-4\">\n                    <NetworkBadge />\n                    <ConnectWalletButton />\n                </div>\n            </nav>\n\n            {/* Main Content */}\n            <div className=\"pt-20 pb-12 px-4 md:px-8 font-mono mt-8\">\n                {/* Header */}\n                <div className=\"max-w-5xl mx-auto mb-6 text-center\">\n                    <h1 className=\"text-2xl md:text-4xl lg:text-5xl font-bold tracking-tighter text-white mb-6 drop-shadow-2xl\">\n          <span className=\"text-transparent bg-clip-text bg-gradient-to-b from-white to-muted font-mono\">\nBatch Payment          </span>\n          \n        </h1>\n                    <p className=\"text-sm md:text-md lg:text-lg  tracking-tighter text-white/40 mb-6 drop-shadow-2xl\">\n                        Pay up to {SAFE_LIMITS.MAX_TOTAL_RECIPIENTS} recipients with a single signature\n                    </p>\n                </div>\n\n                {/* Freighter Not Installed Warning */}\n                {!walletState.isInstalled && (\n                    <div className=\"max-w-6xl mx-auto mb-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-xl\">\n                        <div className=\"flex items-center gap-3\">\n                            <svg className=\"w-5 h-5 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                            </svg>\n                            <div>\n                                <p className=\"text-yellow-200 font-medium\">Freighter Wallet Required</p>\n                                <p className=\"text-yellow-200/70 text-sm\">\n                                    Install the{' '}\n                                    <a\n                                        href=\"https://freighter.app\"\n                                        target=\"_blank\"\n                                        rel=\"noopener noreferrer\"\n                                        className=\"underline hover:text-yellow-100\"\n                                    >\n                                        Freighter browser extension\n                                    </a>{' '}\n                                    to use batch payments.\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {/* Content Grid */}\n                <div className=\"max-w-5xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                    {/* Left Column - Recipients Input */}\n                    <div className=\"space-y-6 bg-gradient-to-br from-white/5 to-muted/10 backdrop-blur-lg rounded-2xl border border-white/10 p-6\">\n                        <div className=\"backdrop-blur-lg rounded-2xl  p-6\">\n                            <h2 className=\"text-lg font-semibold mb-4\">Recipients</h2>\n                            <RecipientsInput\n                                recipients={recipients}\n                                onRecipientsChange={setRecipients}\n                                disabled={isProcessing}\n                            />\n                        </div>\n\n                        {/* Payment Summary */}\n                        {validRecipients.length >0 && <div className=\"bg-black/40 backdrop-blur-lg rounded-2xl  p-6\">\n                            <h2 className=\"text-lg font-semibold mb-4\">Payment Summary</h2>\n                            <div className=\"space-y-4\">\n                                <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-white/60\">Recipients</span>\n                                    <span className=\"font-medium\">{validRecipients.length}</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-white/60\">Batches</span>\n                                    <span className=\"font-medium\">{batchInfo.length}</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-white/60\">Total Amount</span>\n                                    <span className=\"font-medium\">{totalAmount.toFixed(7)} XLM</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-white/60\">Signatures Required</span>\n                                    <span className=\"font-medium text-green-400\">1</span>\n                                </div>\n                                <div className=\"h-px bg-white/10\" />\n                                <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-white/60\">Estimated Fee</span>\n                                    <span className=\"font-medium text-white/80\">~0.01 XLM</span>\n                                </div>\n                                {walletState.address && (\n                                    <>\n                                        <div className=\"h-px bg-white/10\" />\n                                        <div className=\"flex justify-between items-center\">\n                                            <span className=\"text-white/60\">From</span>\n                                            <span className=\"font-mono text-sm text-white/80\">\n                                                {formatAddress(walletState.address)}\n                                            </span>\n                                        </div>\n                                    </>\n                                )}\n                            </div>\n                        </div>}\n\n                        {/* Action Button */}\n                        <button\n                            onClick={executeBatchPayment}\n                            disabled={!canSubmit}\n                            className={`w-full overflow-hidden py-4 rounded-xl font-medium text-lg transition-all ${\n                                canSubmit\n                                    ? 'bg-gradient-to-br from-white/60 to-mute text-black hover:opacity-90'\n                                    : ' text-white/40 cursor-not-allowed'\n                            }`}\n                        >\n                            {isProcessing ? (\n                                <span className=\"flex items-center justify-center gap-2\">\n                                    <svg className=\"w-5 h-5 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n                                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                                    </svg>\n                                    {txStatus.state === 'success' \n                                        ? 'Completing...'\n                                        : txStatus.message}\n                                </span>\n                            ) : !walletState.isConnected ? (\n                                'Connect Wallet to Continue'\n                            ) : validRecipients.length === 0 ? (\n                                'Add Recipients to Continue'\n                            ) : (\n                                `Pay ${validRecipients.length} Recipients`\n                            )}\n                        </button>\n\n                        {/* Status Message */}\n                        {txStatus.state !== 'idle' && (\n                            <div\n                                className={`p-4 rounded-xl border ${\n                                    txStatus.state === 'error'\n                                        ? 'bg-red-500/10 border-red-500/20'\n                                        : txStatus.state === 'success'\n                                        ? 'bg-green-500/10 border-green-500/20'\n                                        : 'bg-blue-500/10 border-blue-500/20'\n                                }`}\n                            >\n                                <div className=\"flex items-center gap-2\">\n                                    {txStatus.state === 'success' && (\n                                        <svg className=\"w-5 h-5 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                                        </svg>\n                                    )}\n                                    {txStatus.state === 'error' && (\n                                        <svg className=\"w-5 h-5 text-red-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                                        </svg>\n                                    )}\n                                    <span\n                                        className={\n                                            txStatus.state === 'error'\n                                                ? 'text-red-400'\n                                                : txStatus.state === 'success'\n                                                ? 'text-green-400'\n                                                : 'text-blue-400'\n                                        }\n                                    >\n                                        {txStatus.message}\n                                    </span>\n                                </div>\n                                {txStatus.error && (\n                                    <p className=\"mt-2 text-sm text-white/50\">{txStatus.error}</p>\n                                )}\n                                {txStatus.hash && txStatus.state === 'success' && (\n                                    <div className=\"mt-3\">\n                                        <a\n                                            href={`https://stellar.expert/explorer/testnet/tx/${txStatus.hash}`}\n                                            target=\"_blank\"\n                                            rel=\"noopener noreferrer\"\n                                            className=\"text-sm text-blue-400 hover:text-blue-300 font-mono break-all\"\n                                        >\n                                            View on Stellar Expert →\n                                        </a>\n                                        <p className=\"text-xs text-white/40 mt-2 font-mono\">\n                                            TX: {txStatus.hash}\n                                        </p>\n                                    </div>\n                                )}\n                                {(txStatus.state === 'error' || txStatus.state === 'success') && (\n                                    <button\n                                        onClick={resetTransaction}\n                                        className=\"mt-3 text-sm text-white/50 hover:text-white\"\n                                    >\n                                        {txStatus.state === 'success' ? 'New Payment' : 'Try Again'}\n                                    </button>\n                                )}\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Right Column - Auth Tree Visualization */}\n                    <div className=\"space-y-6 bg-gradient-to-br from-white/5 to-muted/10 backdrop-blur-lg rounded-2xl border border-white/10 p-6\">\n                        <AuthTreeVisualization\n                            batches={batchInfo}\n                            isProcessing={isTransactionInProgress}\n                            isComplete={txStatus.state === 'success'}\n                            transactionHash={txStatus.hash}\n                            transactionState={txStatus.state}\n                            onVisualizationComplete={handleVisualizationComplete}\n                        />\n\n                        {/* How It Works */}\n                        <div className=\"bg-black/40 backdrop-blur-lg rounded-2xl border border-white/4 p-6\">\n                            <h3 className=\"text-lg font-semibold mb-4\">How It Works</h3>\n                            <div className=\"space-y-4\">\n                                <div className=\"flex gap-3\">\n                                    <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs text-blue-400\">\n                                        1\n                                    </div>\n                                    <div>\n                                        <div className=\"font-medium text-sm\">Add Recipients</div>\n                                        <div className=\"text-xs text-white/50\">\n                                            Upload a CSV or manually enter up to {SAFE_LIMITS.MAX_TOTAL_RECIPIENTS} recipients\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"flex gap-3\">\n                                    <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs text-blue-400\">\n                                        2\n                                    </div>\n                                    <div>\n                                        <div className=\"font-medium text-sm\">Build Auth Tree</div>\n                                        <div className=\"text-xs text-white/50\">\n                                            Recipients are split into batches of {SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH} for optimal processing\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"flex gap-3\">\n                                    <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs text-blue-400\">\n                                        3\n                                    </div>\n                                    <div>\n                                        <div className=\"font-medium text-sm\">Sign with Freighter</div>\n                                        <div className=\"text-xs text-white/50\">\n                                            One signature authorizes all payments atomically\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"flex gap-3\">\n                                    <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs text-green-400\">\n                                        4\n                                    </div>\n                                    <div>\n                                        <div className=\"font-medium text-sm\">Execute</div>\n                                        <div className=\"text-xs text-white/50\">\n                                            All payments succeed or fail together in one transaction\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Limits Info */}\n                        <div className=\"bg-white/5 rounded-xl p-4\">\n                            <h4 className=\"text-sm font-medium mb-3\">Current Limits</h4>\n                            <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-white/50\">Max Recipients</span>\n                                    <span>{SAFE_LIMITS.MAX_TOTAL_RECIPIENTS}</span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-white/50\">Per Batch</span>\n                                    <span>{SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH}</span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-white/50\">Max Batches</span>\n                                    <span>{SAFE_LIMITS.MAX_BATCHES}</span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-white/50\">Network</span>\n                                    <span className=\"text-yellow-400\">Testnet</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Footer */}\n            <footer className=\"border-t border-white/10 py-6 px-8 lg:px-16\">\n                <div className=\"max-w-6xl mx-auto flex items-center justify-between text-sm text-white/40\">\n                    <span>Powered by Stellar Soroban</span>\n                    <span>Tesseract - 4D Privacy on 2D Ledger</span>\n                </div>\n            </footer>\n        </div>\n    );\n}\n\n// Wrap with WalletProvider\nexport default function BatchPayments() {\n    return (\n        <WalletProvider>\n            <BatchPaymentsContent />\n        </WalletProvider>\n    );\n}\n","import {\n    Address,\n    Keypair,\n    Operation,\n    rpc,\n    TransactionBuilder,\n    xdr,\n    nativeToScVal,\n    hash,\n    Account,\n    Networks,\n} from '@stellar/stellar-sdk';\n\n// ==================== CONFIGURATION ====================\n\nconst CONFIG = {\n    TESTNET: {\n        RPC_URL: 'https://soroban-testnet.stellar.org',\n        HORIZON_URL: 'https://horizon-testnet.stellar.org',\n        NETWORK_PASSPHRASE: Networks.TESTNET,\n        ORCHESTRATOR_CONTRACT: 'CBYD7XCJH6RCA27AXXJDO3ARZHQJIW5BYEHAUKJ7QS6NQMLIQ2KMJ3K2',\n        XLM_SAC: 'CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC',\n    },\n    MAINNET: {\n        RPC_URL: 'https://soroban-rpc.stellar.org',\n        HORIZON_URL: 'https://horizon.stellar.org',\n        NETWORK_PASSPHRASE: Networks.PUBLIC,\n        ORCHESTRATOR_CONTRACT: '', // TODO: Deploy and update for mainnet\n        XLM_SAC: 'CAS3J7GYLGXMF6TDJBBYYSE3HQ6BBSMLNUQ34T6TZMYMW2EVH34XOWMA',\n    },\n};\n\n// Worker contracts for batch processing (20 available)\nconst WORKER_CONTRACTS: Record<string, string> = {\n    worker1: 'CA46744JXE6PUFP2E4G26QKBG3DTA3RIGGWGTP2QIEKZ6U3CQ3LKM7SH',\n    worker2: 'CAWHF5NQMVED6ANSUMG3OXEMWQHOX2K53VSOK5FO3MMMG7Y5YMFMZABZ',\n    worker3: 'CC6VG5BLTU4SIZQAFOQZOIOEKLQAR2NYTMPOLZVULK7ZHYUTE7YKORPJ',\n    worker4: 'CCOV6M4AEP7TGZ3NIMFGUXMWO3TXSWHSHDGGMIYNN7QM2COM7ITEJBMU',\n    worker5: 'CDWIM6L5FKT3PQ7PCM5UFUIWPS22YVQWUMIMPKLPKBVFUKD5JJUQNH27',\n    worker6: 'CD236CW2YLUXXWK4WT6BRDKMDDCKZKPU5RJRSVL64H6XZLXEU3UZ73GF',\n    worker7: 'CB7O7WGBXMVGES75LSLVC277YIHVHGO75RN7YJELE7IQ2664TMZ4OLG6',\n    worker8: 'CBAUCRBOPXN33TIUIMBCQ2BPWPA446IWMK32KYO43RGOLG3KPBE3L5J2',\n    worker9: 'CCM6WJHG6CDN7YCR4BVSFKJVQEOW5BA6IHH6RSXX5QRPLNS7E4UL4SLN',\n    worker10: 'CBHRLC3IY6OIOGTU4E737IKPWV46N43NLTJX2ZIYGK7ZI6B4TRL7HIIC',\n    worker11: 'CC6N434Q5GH4TIN4NVXK7FWZHLEAAC3MIZATRHT3YK2VEAVK3GKW62CE',\n    worker12: 'CBGMTVKUULAVZ3UJQMJ74SISODP5FV5W2UGSWXHYGXUAYGLMXTM3QKHH',\n    worker13: 'CBCWTKVJEVDNYLMK7PD5VU67IX46BPCSOH75EINCF4MIYJW7HUF2O7P6',\n    worker14: 'CCNZ753NQBP67AZSYCQNLCVW56ZAY36AQMTNOBI2WKLP4GNR5ARBRIES',\n    worker15: 'CAEPOYMB33T6MQXNA2C5HLXNCKHLC5RCMF7EFCMPB3M2764RRUACC2E6',\n    worker16: 'CCJYOSKABCA4XDATIPB4BJI63GQ25AMGXFQSY6KSZ3AMCWAD6OF4L3RW',\n    worker17: 'CBEJCOJBK5QWHSOPLZY6OGY2446JXC5UJG2565NAQNP2BBY3WSRWZD57',\n    worker18: 'CB2TXKCIFCITSG4QICQAWJ4GPVJ6YBVBKBPTEAA5IDHL2QKHZ7FCLGNK',\n    worker19: 'CCTMP2VNVVSABI7J2L442KTBLRHYAMVIB632UTBZYZDMV3RIGU4OUBBY',\n    worker20: 'CBFYQMR7BY7CANCIWJEAL7LYVURWUIKZZZFM3FR2B765HZKTGYLEYLWW',\n};\n\n// ==================== TYPE DEFINITIONS ====================\n\nexport interface PaymentRecipient {\n    address: string;\n    amount: bigint; // In stroops (1 XLM = 10_000_000n)\n}\n\nexport interface BatchConfig {\n    workerContractId: string;\n    recipients: string[];\n    amounts: bigint[];\n}\n\nexport interface AuthTreeBuildResult {\n    authEntry: xdr.SorobanAuthorizationEntry;\n    authPayload: Buffer;           // Hash of preimage (for manual signing)\n    authPreimageXdr: string;       // Base64 XDR of preimage (for Freighter signAuthEntry)\n    expirationLedger: number;\n    nonce: bigint;\n}\n\nexport interface TransactionResult {\n    success: boolean;\n    hash?: string;\n    ledger?: number;\n    error?: string;\n    totalPayments?: number;\n}\n\nexport type NetworkType = 'testnet' | 'mainnet';\n\n// ==================== SAFE LIMITS ====================\n\nexport const SAFE_LIMITS = {\n    MAX_RECIPIENTS_PER_BATCH: 19,  // Don't use 20 (contract limit buffer)\n    MAX_TOTAL_RECIPIENTS: 80,      // Stay under 81 for resource limits\n    MAX_BATCHES: 5,                // 5 batches × 19 = 95, but 80 is safer\n    FEE_BUFFER_MULTIPLIER: 2.0,   // 2x the simulated fee\n    STROOPS_PER_XLM: 10_000_000n,\n};\n\n// ==================== MAIN SERVICE CLASS ====================\n\nexport class BulkPaymentService {\n    private server: rpc.Server;\n    private networkPassphrase: string;\n    private orchestratorContract: string;\n    private xlmSac: string;\n    private workerContracts: string[];\n\n    constructor(network: NetworkType = 'testnet') {\n        const config = network === 'mainnet' ? CONFIG.MAINNET : CONFIG.TESTNET;\n\n        this.server = new rpc.Server(config.RPC_URL, { allowHttp: true });\n        this.networkPassphrase = config.NETWORK_PASSPHRASE;\n        this.orchestratorContract = config.ORCHESTRATOR_CONTRACT;\n        this.xlmSac = config.XLM_SAC;\n        this.workerContracts = Object.values(WORKER_CONTRACTS);\n    }\n\n    // ==================== PUBLIC METHODS ====================\n\n    /**\n     * Validates and creates batches from a list of recipients\n     * Returns error if validation fails\n     */\n    validateAndCreateBatches(recipients: PaymentRecipient[]): {\n        batches?: BatchConfig[];\n        error?: string;\n        stats?: {\n            totalRecipients: number;\n            totalAmount: bigint;\n            batchCount: number;\n            recipientsPerBatch: number[];\n        };\n    } {\n        // Validate recipient count\n        if (recipients.length === 0) {\n            return { error: 'No recipients provided' };\n        }\n\n        if (recipients.length > SAFE_LIMITS.MAX_TOTAL_RECIPIENTS) {\n            return {\n                error: `Maximum ${SAFE_LIMITS.MAX_TOTAL_RECIPIENTS} recipients per transaction. You provided ${recipients.length}.`\n            };\n        }\n\n        // Validate addresses and amounts\n        for (let i = 0; i < recipients.length; i++) {\n            const r = recipients[i];\n\n            // Validate address format (basic check)\n            if (!r.address || r.address.length !== 56 || !r.address.startsWith('G')) {\n                return { error: `Invalid Stellar address at row ${i + 1}: ${r.address}` };\n            }\n\n            // Validate amount\n            if (r.amount <= 0n) {\n                return { error: `Amount must be positive at row ${i + 1}` };\n            }\n        }\n\n        // Create batches\n        const batches: BatchConfig[] = [];\n        const recipientsPerBatch: number[] = [];\n\n        for (let i = 0; i < recipients.length; i += SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH) {\n            const batchRecipients = recipients.slice(i, i + SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH);\n            const workerIndex = batches.length % this.workerContracts.length;\n\n            batches.push({\n                workerContractId: this.workerContracts[workerIndex],\n                recipients: batchRecipients.map(r => r.address),\n                amounts: batchRecipients.map(r => r.amount),\n            });\n\n            recipientsPerBatch.push(batchRecipients.length);\n        }\n\n        const totalAmount = recipients.reduce((sum, r) => sum + r.amount, 0n);\n\n        return {\n            batches,\n            stats: {\n                totalRecipients: recipients.length,\n                totalAmount,\n                batchCount: batches.length,\n                recipientsPerBatch,\n            },\n        };\n    }\n\n    /**\n     * Builds the 3-level authorization tree for orchestrated payments\n     * This is the key function that enables SINGLE SIGNATURE for all batches\n     */\n    async buildAuthTree(\n        userPublicKey: string,\n        batches: BatchConfig[]\n    ): Promise<AuthTreeBuildResult> {\n        // Get current ledger for nonce and expiration\n        const ledgerResponse = await this.server.getLatestLedger();\n        const currentLedger = ledgerResponse.sequence;\n        const expirationLedger = currentLedger + 1000; // ~83 minutes validity\n        const nonce = BigInt(currentLedger);\n\n        // Build Level 3: Token transfer sub-invocations for each batch\n        const batchSubInvocations: xdr.SorobanAuthorizedInvocation[] = batches.map(batch => {\n            // Build transfer invocations (Level 3)\n            const transferInvocations = batch.recipients.map((recipient, i) => {\n                return new xdr.SorobanAuthorizedInvocation({\n                    function: xdr.SorobanAuthorizedFunction.sorobanAuthorizedFunctionTypeContractFn(\n                        new xdr.InvokeContractArgs({\n                            contractAddress: new Address(this.xlmSac).toScAddress(),\n                            functionName: 'transfer',\n                            args: [\n                                new Address(userPublicKey).toScVal(),\n                                new Address(recipient).toScVal(),\n                                nativeToScVal(batch.amounts[i], { type: 'i128' }),\n                            ],\n                        })\n                    ),\n                    subInvocations: [],\n                });\n            });\n\n            // Build Level 2: Worker batch_pay invocation\n            return new xdr.SorobanAuthorizedInvocation({\n                function: xdr.SorobanAuthorizedFunction.sorobanAuthorizedFunctionTypeContractFn(\n                    new xdr.InvokeContractArgs({\n                        contractAddress: new Address(batch.workerContractId).toScAddress(),\n                        functionName: 'batch_pay',\n                        args: [\n                            new Address(userPublicKey).toScVal(),\n                            xdr.ScVal.scvVec(batch.recipients.map(r => new Address(r).toScVal())),\n                            xdr.ScVal.scvVec(batch.amounts.map(a => nativeToScVal(a, { type: 'i128' }))),\n                            new Address(this.xlmSac).toScVal(),\n                        ],\n                    })\n                ),\n                subInvocations: transferInvocations,\n            });\n        });\n\n        // Build Level 1: Orchestrator root invocation\n        // Convert batches to BatchConfig ScVal format\n        // IMPORTANT: Map entries MUST be in alphabetical order for Soroban\n        const batchesScVal = xdr.ScVal.scvVec(\n            batches.map(batch =>\n                xdr.ScVal.scvMap([\n                    new xdr.ScMapEntry({\n                        key: xdr.ScVal.scvSymbol('amounts'),\n                        val: xdr.ScVal.scvVec(batch.amounts.map(a => nativeToScVal(a, { type: 'i128' }))),\n                    }),\n                    new xdr.ScMapEntry({\n                        key: xdr.ScVal.scvSymbol('recipients'),\n                        val: xdr.ScVal.scvVec(batch.recipients.map(r => new Address(r).toScVal())),\n                    }),\n                    new xdr.ScMapEntry({\n                        key: xdr.ScVal.scvSymbol('worker_contract'),\n                        val: new Address(batch.workerContractId).toScVal(),\n                    }),\n                ])\n            )\n        );\n\n        const rootInvocation = new xdr.SorobanAuthorizedInvocation({\n            function: xdr.SorobanAuthorizedFunction.sorobanAuthorizedFunctionTypeContractFn(\n                new xdr.InvokeContractArgs({\n                    contractAddress: new Address(this.orchestratorContract).toScAddress(),\n                    functionName: 'orchestrate_payments',\n                    args: [\n                        new Address(userPublicKey).toScVal(),\n                        batchesScVal,\n                        new Address(this.xlmSac).toScVal(),\n                    ],\n                })\n            ),\n            subInvocations: batchSubInvocations,\n        });\n\n        // Build the authorization entry with credentials placeholder\n        const authEntry = new xdr.SorobanAuthorizationEntry({\n            credentials: xdr.SorobanCredentials.sorobanCredentialsAddress(\n                new xdr.SorobanAddressCredentials({\n                    address: new Address(userPublicKey).toScAddress(),\n                    nonce: xdr.Int64.fromString(nonce.toString()),\n                    signatureExpirationLedger: expirationLedger,\n                    signature: xdr.ScVal.scvVoid(), // Placeholder - will be filled after signing\n                })\n            ),\n            rootInvocation: rootInvocation,\n        });\n\n        // Compute the hash payload that needs to be signed\n        const networkId = hash(Buffer.from(this.networkPassphrase));\n        const hashIdPreimage = xdr.HashIdPreimage.envelopeTypeSorobanAuthorization(\n            new xdr.HashIdPreimageSorobanAuthorization({\n                networkId: networkId,\n                nonce: xdr.Int64.fromString(nonce.toString()),\n                signatureExpirationLedger: expirationLedger,\n                invocation: rootInvocation,\n            })\n        );\n\n        // Get the preimage XDR for Freighter (it hashes internally)\n        const preimageXdr = hashIdPreimage.toXDR();\n        const authPreimageXdr = preimageXdr.toString('base64');\n        \n        // Also compute the hash for manual signing scenarios\n        const authPayload = hash(preimageXdr);\n\n        return {\n            authEntry,\n            authPayload,\n            authPreimageXdr,\n            expirationLedger,\n            nonce,\n        };\n    }\n\n    /**\n     * Signs the authorization entry with the wallet's signing function\n     * Returns the signed auth entry ready for transaction submission\n     */\n    async signAuthEntry(\n        authEntry: xdr.SorobanAuthorizationEntry,\n        userPublicKey: string,\n        signFunction: (payload: Buffer) => Promise<Buffer>,\n        authPayload: Buffer\n    ): Promise<xdr.SorobanAuthorizationEntry> {\n        // Get the signature from the wallet\n        const signature = await signFunction(authPayload);\n\n        // Build the signature ScVal - MUST be Vec<Map> format for Stellar/Soroban\n        // The Vec allows for multiple signers, Map contains public_key and signature\n        const signatureScVal = xdr.ScVal.scvVec([\n            xdr.ScVal.scvMap([\n                new xdr.ScMapEntry({\n                    key: xdr.ScVal.scvSymbol('public_key'),\n                    val: xdr.ScVal.scvBytes(Keypair.fromPublicKey(userPublicKey).rawPublicKey()),\n                }),\n                new xdr.ScMapEntry({\n                    key: xdr.ScVal.scvSymbol('signature'),\n                    val: xdr.ScVal.scvBytes(signature),\n                }),\n            ]),\n        ]);\n\n        // Create new credentials with the signature\n        const credentials = authEntry.credentials();\n        const addressCreds = credentials.address();\n\n        const signedCredentials = xdr.SorobanCredentials.sorobanCredentialsAddress(\n            new xdr.SorobanAddressCredentials({\n                address: addressCreds.address(),\n                nonce: addressCreds.nonce(),\n                signatureExpirationLedger: addressCreds.signatureExpirationLedger(),\n                signature: signatureScVal,\n            })\n        );\n\n        return new xdr.SorobanAuthorizationEntry({\n            credentials: signedCredentials,\n            rootInvocation: authEntry.rootInvocation(),\n        });\n    }\n\n    /**\n     * Submits the signed authorization entry as a transaction\n     * Returns the transaction result\n     */\n    async submitTransaction(\n        signedAuthEntry: xdr.SorobanAuthorizationEntry,\n        serviceSecretKey: string\n    ): Promise<TransactionResult> {\n        const serviceKeypair = Keypair.fromSecret(serviceSecretKey);\n        const serviceAddress = serviceKeypair.publicKey();\n\n        console.log('=== Submit Transaction Debug ===');\n        console.log('Service address:', serviceAddress);\n        console.log('Orchestrator contract:', this.orchestratorContract);\n        console.log('XLM SAC:', this.xlmSac);\n\n        // Load service account\n        let serviceAccount: Account;\n        try {\n            serviceAccount = await this.server.getAccount(serviceAddress);\n        } catch (e) {\n            return {\n                success: false,\n                error: `Failed to load service account: ${serviceAddress}. Ensure it is funded.`,\n            };\n        }\n\n        // Extract the invoke contract args from the auth entry\n        const rootInvocation = signedAuthEntry.rootInvocation();\n        const invokeContractArgs = rootInvocation.function().contractFn();\n\n        // Create the host function\n        const hostFunction = xdr.HostFunction.hostFunctionTypeInvokeContract(invokeContractArgs);\n\n        // Create the invoke operation\n        const invokeOp = Operation.invokeHostFunction({\n            func: hostFunction,\n            auth: [signedAuthEntry],\n        });\n\n        // Build transaction for simulation\n        const simTx = new TransactionBuilder(serviceAccount, {\n            fee: '100',\n            networkPassphrase: this.networkPassphrase,\n        })\n            .addOperation(invokeOp)\n            .setTimeout(60)\n            .build();\n\n        // Simulate\n        const simResponse = await this.server.simulateTransaction(simTx);\n\n        if (rpc.Api.isSimulationError(simResponse)) {\n            // Extract more detailed error info\n            console.error('=== Simulation Error ===');\n            console.error('Error:', simResponse.error);\n            console.error('Full response:', JSON.stringify(simResponse, null, 2));\n            \n            // Try to extract more specific error info\n            let errorMessage = simResponse.error || 'Unknown simulation error';\n            \n            return {\n                success: false,\n                error: `Simulation failed: ${errorMessage}`,\n            };\n        }\n\n        // Build final transaction with resource data\n        const sorobanData = simResponse.transactionData?.build();\n        const feeWithBuffer = Math.ceil(\n            parseInt(simResponse.minResourceFee || '0') * SAFE_LIMITS.FEE_BUFFER_MULTIPLIER\n        );\n\n        // Reload account for correct sequence number\n        serviceAccount = await this.server.getAccount(serviceAddress);\n\n        const finalTx = new TransactionBuilder(serviceAccount, {\n            fee: feeWithBuffer.toString(),\n            networkPassphrase: this.networkPassphrase,\n        })\n            .setSorobanData(sorobanData!)\n            .addOperation(invokeOp)\n            .setTimeout(90)\n            .build();\n\n        // Sign with service key (pays fees)\n        finalTx.sign(serviceKeypair);\n\n        // Submit\n        const sendResponse = await this.server.sendTransaction(finalTx);\n\n        if (sendResponse.status !== 'PENDING') {\n            return {\n                success: false,\n                error: `Transaction submission failed. Status: ${sendResponse.status}`,\n            };\n        }\n\n        // Wait for confirmation\n        let txStatus = await this.server.getTransaction(sendResponse.hash);\n        let attempts = 0;\n        const maxAttempts = 30;\n\n        while (txStatus.status === 'NOT_FOUND' && attempts < maxAttempts) {\n            await new Promise(resolve => setTimeout(resolve, 1000));\n            txStatus = await this.server.getTransaction(sendResponse.hash);\n            attempts++;\n        }\n\n        if (txStatus.status === 'SUCCESS') {\n            return {\n                success: true,\n                hash: sendResponse.hash,\n                ledger: txStatus.ledger,\n            };\n        }\n\n        return {\n            success: false,\n            error: `Transaction failed with status: ${txStatus.status}`,\n            hash: sendResponse.hash,\n        };\n    }\n\n\n    /**\n     * Checks if a Stellar account exists on the network.\n     * @param publicKey The public key of the account to check.\n     * @returns An object indicating if the account exists and an error message if not.\n     */\n    async checkAccountExists(publicKey: string): Promise<{ exists: boolean; error?: string }> {\n        try {\n            await this.server.getAccount(publicKey);\n            return { exists: true };\n        } catch (e: any) {\n            if (e.message?.includes('Not Found') || e.code === 404) {\n                return {\n                    exists: false,\n                    error: `Account ${publicKey} does not exist on the network. Please fund it first.`\n                };\n            }\n            // Re-throw or return a generic error if it's not a \"Not Found\" issue\n            return { exists: false, error: e.message || 'An unknown error occurred while checking account existence.' };\n        }\n    }\n\n    // ==================== UTILITY METHODS ====================\n\n    /**\n     * Converts XLM to stroops\n     */\n    static xlmToStroops(xlm: number | string): bigint {\n        const xlmNum = typeof xlm === 'string' ? parseFloat(xlm) : xlm;\n        return BigInt(Math.floor(xlmNum * Number(SAFE_LIMITS.STROOPS_PER_XLM)));\n    }\n\n    /**\n     * Converts stroops to XLM\n     */\n    static stroopsToXlm(stroops: bigint): string {\n        return (Number(stroops) / Number(SAFE_LIMITS.STROOPS_PER_XLM)).toFixed(7);\n    }\n\n    /**\n     * Parses CSV content into payment recipients\n     * Expected format: address,amount (amount in XLM)\n     */\n    static parseCSV(csvContent: string): {\n        recipients?: PaymentRecipient[];\n        error?: string;\n        warnings?: string[];\n    } {\n        const lines = csvContent.trim().split('\\n');\n        const recipients: PaymentRecipient[] = [];\n        const warnings: string[] = [];\n\n        // Skip header if present\n        let startLine = 0;\n        const firstLine = lines[0].toLowerCase();\n        if (firstLine.includes('address') || firstLine.includes('recipient') || firstLine.includes('amount')) {\n            startLine = 1;\n        }\n\n        for (let i = startLine; i < lines.length; i++) {\n            const line = lines[i].trim();\n            if (!line) continue;\n\n            const parts = line.split(',').map(p => p.trim());\n            if (parts.length < 2) {\n                return { error: `Invalid format at line ${i + 1}: expected \"address,amount\"` };\n            }\n\n            const address = parts[0];\n            const amountStr = parts[1];\n\n            // Parse amount (assuming XLM)\n            const amount = parseFloat(amountStr);\n            if (isNaN(amount) || amount <= 0) {\n                return { error: `Invalid amount at line ${i + 1}: ${amountStr}` };\n            }\n\n            // Warn about very small amounts\n            if (amount < 0.0000001) {\n                warnings.push(`Very small amount at line ${i + 1}: ${amountStr} XLM`);\n            }\n\n            recipients.push({\n                address,\n                amount: BulkPaymentService.xlmToStroops(amount),\n            });\n        }\n\n        if (recipients.length === 0) {\n            return { error: 'No valid recipients found in CSV' };\n        }\n\n        return { recipients, warnings };\n    }\n\n    /**\n     * Gets the orchestrator contract address\n     */\n    getOrchestratorContract(): string {\n        return this.orchestratorContract;\n    }\n\n    /**\n     * Gets the XLM SAC address\n     */\n    getXlmSac(): string {\n        return this.xlmSac;\n    }\n\n    /**\n     * Gets the RPC server instance\n     */\n    getServer(): rpc.Server {\n        return this.server;\n    }\n}\n\n// Export singleton for convenience\nexport const bulkPaymentService = new BulkPaymentService('testnet');\n","'use client';\n\nimport { useState, useRef, useCallback } from 'react';\nimport { SAFE_LIMITS } from '@/app/services/bulkPaymentService';\n\nexport interface Recipient {\n  id: string;\n  address: string;\n  amount: string;\n  isValid: boolean;\n  error?: string;\n}\n\ninterface RecipientsInputProps {\n  recipients: Recipient[];\n  onRecipientsChange: (recipients: Recipient[]) => void;\n  disabled?: boolean;\n}\n\nexport default function RecipientsInput({\n  recipients,\n  onRecipientsChange,\n  disabled = false,\n}: RecipientsInputProps) {\n  const [dragActive, setDragActive] = useState(false);\n  const [inputMode, setInputMode] = useState<'manual' | 'csv'>('manual');\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Generate unique ID\n  const generateId = () => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  // Validate a single recipient\n  const validateRecipient = (address: string, amount: string): { isValid: boolean; error?: string } => {\n    if (!address.trim()) {\n      return { isValid: false, error: 'Address required' };\n    }\n\n    if (address.length !== 56 || !address.startsWith('G')) {\n      return { isValid: false, error: 'Invalid Stellar address' };\n    }\n\n    const amountNum = parseFloat(amount);\n    if (isNaN(amountNum) || amountNum <= 0) {\n      return { isValid: false, error: 'Invalid amount' };\n    }\n\n    return { isValid: true };\n  };\n\n  // Add empty recipient row\n  const addRecipient = () => {\n    if (recipients.length >= SAFE_LIMITS.MAX_TOTAL_RECIPIENTS) return;\n\n    const newRecipient: Recipient = {\n      id: generateId(),\n      address: '',\n      amount: '',\n      isValid: false,\n    };\n    onRecipientsChange([...recipients, newRecipient]);\n  };\n\n  // Update recipient\n  const updateRecipient = (id: string, field: 'address' | 'amount', value: string) => {\n    const updated = recipients.map((r) => {\n      if (r.id !== id) return r;\n\n      const newAddress = field === 'address' ? value : r.address;\n      const newAmount = field === 'amount' ? value : r.amount;\n      const validation = validateRecipient(newAddress, newAmount);\n\n      return {\n        ...r,\n        [field]: value,\n        isValid: validation.isValid,\n        error: validation.error,\n      };\n    });\n    onRecipientsChange(updated);\n  };\n\n  // Remove recipient\n  const removeRecipient = (id: string) => {\n    if (recipients.length <= 1) return;\n    onRecipientsChange(recipients.filter((r) => r.id !== id));\n  };\n\n  // Handle CSV file upload\n  const handleFileUpload = useCallback(\n    (file: File) => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const content = e.target?.result as string;\n        const lines = content.trim().split('\\n');\n\n        // Skip header if present\n        let startLine = 0;\n        const firstLine = lines[0].toLowerCase();\n        if (firstLine.includes('address') || firstLine.includes('recipient')) {\n          startLine = 1;\n        }\n\n        const newRecipients: Recipient[] = [];\n\n        for (let i = startLine; i < lines.length && newRecipients.length < SAFE_LIMITS.MAX_TOTAL_RECIPIENTS; i++) {\n          const line = lines[i].trim();\n          if (!line) continue;\n\n          const parts = line.split(',').map((p) => p.trim());\n          if (parts.length >= 2) {\n            const address = parts[0];\n            const amount = parts[1];\n            const validation = validateRecipient(address, amount);\n\n            newRecipients.push({\n              id: generateId(),\n              address,\n              amount,\n              isValid: validation.isValid,\n              error: validation.error,\n            });\n          }\n        }\n\n        if (newRecipients.length > 0) {\n          onRecipientsChange(newRecipients);\n          setInputMode('csv');\n        }\n      };\n      reader.readAsText(file);\n    },\n    [onRecipientsChange]\n  );\n\n  // Handle drag events\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === 'dragenter' || e.type === 'dragover') {\n      setDragActive(true);\n    } else if (e.type === 'dragleave') {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileUpload(e.dataTransfer.files[0]);\n    }\n  };\n\n  // Clear all and reset\n  const clearAll = () => {\n    onRecipientsChange([\n      {\n        id: generateId(),\n        address: '',\n        amount: '',\n        isValid: false,\n      },\n    ]);\n    setInputMode('manual');\n  };\n\n  const validCount = recipients.filter((r) => r.isValid).length;\n  const totalAmount = recipients\n    .filter((r) => r.isValid)\n    .reduce((sum, r) => sum + parseFloat(r.amount), 0);\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Mode Toggle and Info */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex bg-white/5 rounded-lg p-1\">\n            <button\n              onClick={() => setInputMode('manual')}\n              className={`px-3 py-1.5 text-sm rounded-md transition-all ${\n                inputMode === 'manual'\n                  ? 'bg-white/10 text-white'\n                  : 'text-white/50 hover:text-white'\n              }`}\n              disabled={disabled}\n            >\n              Manual Entry\n            </button>\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              className={`px-3 py-1.5 text-sm rounded-md transition-all ${\n                inputMode === 'csv'\n                  ? 'bg-white/10 text-white'\n                  : 'text-white/50 hover:text-white'\n              }`}\n              disabled={disabled}\n            >\n              Upload CSV\n            </button>\n          </div>\n        </div>\n\n        <div className=\"text-sm text-white/50\">\n          {validCount}/{SAFE_LIMITS.MAX_TOTAL_RECIPIENTS} recipients\n        </div>\n      </div>\n\n      {/* CSV Drop Zone */}\n      <div\n        className={`relative border-2 border-dashed rounded-xl p-6 text-center transition-all ${\n          dragActive\n            ? 'border-blue-500 bg-blue-500/10'\n            : 'border-white/20 hover:border-white/30'\n        } ${disabled ? 'opacity-50 pointer-events-none' : ''}`}\n        onDragEnter={handleDrag}\n        onDragLeave={handleDrag}\n        onDragOver={handleDrag}\n        onDrop={handleDrop}\n      >\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\".csv,.txt\"\n          onChange={(e) => e.target.files?.[0] && handleFileUpload(e.target.files[0])}\n          className=\"hidden\"\n          disabled={disabled}\n        />\n\n        <svg className=\"w-10 h-10 mx-auto mb-3 text-white/30\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n        </svg>\n        <p className=\"text-sm text-white/60 mb-1\">\n          Drag and drop CSV file here, or{' '}\n          <button\n            onClick={() => fileInputRef.current?.click()}\n            className=\"text-blue-400 hover:text-blue-300\"\n            disabled={disabled}\n          >\n            browse\n          </button>\n        </p>\n        <p className=\"text-xs text-white/40\">Format: address,amount (amount in XLM)</p>\n      </div>\n\n      {/* Recipients Table */}\n      <div className=\"bg-black/20 rounded-xl border border-white/10 overflow-hidden\">\n        {/* Table Header */}\n        <div className=\"grid grid-cols-[1fr_120px_40px] gap-2 px-4 py-3 bg-white/5 border-b border-white/10\">\n          <div className=\"text-xs font-medium text-white/60 uppercase tracking-wider\">\n            Recipient Address\n          </div>\n          <div className=\"text-xs font-medium text-white/60 uppercase tracking-wider\">\n            Amount (XLM)\n          </div>\n          <div></div>\n        </div>\n\n        {/* Table Body */}\n        <div className=\"max-h-[320px] overflow-y-auto\">\n          {recipients.map((recipient, index) => (\n            <div\n              key={recipient.id}\n              className={`grid grid-cols-[1fr_120px_40px] gap-2 px-4 py-2 border-b border-white/5 ${\n                !recipient.isValid && (recipient.address || recipient.amount)\n                  ? 'bg-red-500/5'\n                  : ''\n              }`}\n            >\n              {/* Address Input */}\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  value={recipient.address}\n                  onChange={(e) => updateRecipient(recipient.id, 'address', e.target.value)}\n                  placeholder=\"G...\"\n                  className={`w-full bg-transparent border-0 text-sm font-mono text-white placeholder-white/30 focus:outline-none focus:ring-0 ${\n                    !recipient.isValid && recipient.address ? 'text-red-400' : ''\n                  }`}\n                  disabled={disabled}\n                />\n                {recipient.error && recipient.address && (\n                  <div className=\"absolute -bottom-4 left-0 text-xs text-red-400\">\n                    {recipient.error}\n                  </div>\n                )}\n              </div>\n\n              {/* Amount Input */}\n              <input\n                type=\"number\"\n                step=\"0.0000001\"\n                min=\"0\"\n                value={recipient.amount}\n                onChange={(e) => updateRecipient(recipient.id, 'amount', e.target.value)}\n                placeholder=\"0.00\"\n                className=\"w-full bg-transparent border-0 text-sm text-white placeholder-white/30 focus:outline-none focus:ring-0\"\n                disabled={disabled}\n              />\n\n              {/* Remove Button */}\n              <button\n                onClick={() => removeRecipient(recipient.id)}\n                className=\"flex items-center justify-center text-white/30 hover:text-red-400 transition-colors\"\n                disabled={disabled || recipients.length <= 1}\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n          ))}\n        </div>\n\n        {/* Add Row Button */}\n        <div className=\"px-4 py-3 border-t border-white/10\">\n          <button\n            onClick={addRecipient}\n            disabled={disabled || recipients.length >= SAFE_LIMITS.MAX_TOTAL_RECIPIENTS}\n            className=\"flex items-center gap-2 text-sm text-white/50 hover:text-white transition-colors disabled:opacity-30\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n            </svg>\n            Add Recipient\n          </button>\n        </div>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"grid grid-cols-3 gap-4 p-4 bg-white/5 rounded-xl\">\n        <div>\n          <div className=\"text-xs text-white/40 mb-1\">Valid Recipients</div>\n          <div className=\"text-lg font-semibold text-white\">\n            {validCount}\n            <span className=\"text-sm text-white/40\">/{recipients.length}</span>\n          </div>\n        </div>\n        <div>\n          <div className=\"text-xs text-white/40 mb-1\">Total Amount</div>\n          <div className=\"text-lg font-semibold text-white\">\n            {totalAmount.toFixed(2)}\n            <span className=\"text-sm text-white/40\"> XLM</span>\n          </div>\n        </div>\n        <div>\n          <div className=\"text-xs text-white/40 mb-1\">Batches</div>\n          <div className=\"text-lg font-semibold text-white\">\n            {Math.ceil(validCount / SAFE_LIMITS.MAX_RECIPIENTS_PER_BATCH) || 0}\n          </div>\n        </div>\n      </div>\n\n      {/* Limit Warning */}\n      {recipients.length >= SAFE_LIMITS.MAX_TOTAL_RECIPIENTS  && (\n        <div className=\"flex items-center gap-2 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg\">\n          <svg className=\"w-4 h-4 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n          </svg>\n          <span className=\"text-sm text-yellow-200\">\n            Approaching limit: Maximum {SAFE_LIMITS.MAX_TOTAL_RECIPIENTS} recipients per transaction\n          </span>\n        </div>\n      )}\n\n      {/* Clear Button */}\n      {recipients.length > 1 && (\n        <button\n          onClick={clearAll}\n          disabled={disabled}\n          className=\"text-sm text-white/40 hover:text-white transition-colors\"\n        >\n          Clear all recipients\n        </button>\n      )}\n    </div>\n  );\n}\n","'use client';\n\nimport { useEffect, useState, useRef, useCallback } from 'react';\n\ninterface AuthTreeNode {\n  id: string;\n  label: string;\n  type: 'orchestrator' | 'worker' | 'transfer';\n  children?: AuthTreeNode[];\n  status: 'pending' | 'active' | 'complete';\n}\n\n// Transaction state type matching the parent component\ntype TransactionState = 'idle' | 'preparing' | 'signing' | 'submitting' | 'success' | 'error';\n\ninterface AuthTreeVisualizationProps {\n  batches: {\n    workerIndex: number;\n    recipientCount: number;\n  }[];\n  isProcessing: boolean;\n  isComplete: boolean;\n  transactionHash?: string;\n  // NEW: Actual transaction state for proper synchronization\n  transactionState?: TransactionState;\n  // NEW: Callback when visualization completes its animation\n  onVisualizationComplete?: () => void;\n}\n\n// Completion animation duration (when transaction finishes, how long to animate to 100%)\nconst COMPLETION_ANIMATION_MS = 2000;\n// Minimum progress per phase to show meaningful animation\nconst MIN_PHASE_DURATION_MS = 800;\n\n// Easing function for smooth animations\nfunction easeOutCubic(t: number): number {\n  return 1 - Math.pow(1 - t, 3);\n}\n\nexport default function AuthTreeVisualization({\n  batches,\n  isProcessing,\n  isComplete,\n  transactionHash,\n  transactionState = 'idle',\n  onVisualizationComplete,\n}: AuthTreeVisualizationProps) {\n  const [animationProgress, setAnimationProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState<'idle' | 'building' | 'signing' | 'submitting' | 'complete'>('idle');\n  const [isVisualizationComplete, setIsVisualizationComplete] = useState(false);\n\n  const animationRef = useRef<number | null>(null);\n  const phaseStartTimeRef = useRef<number | null>(null);\n  const completionStartTimeRef = useRef<number | null>(null);\n  const progressAtCompletionRef = useRef<number>(0);\n  const lastPhaseRef = useRef<TransactionState>('idle');\n\n  // Build the tree structure\n  const buildTree = (): AuthTreeNode => {\n    const workers = batches.map((batch, index) => {\n      const transfers = Array.from({ length: batch.recipientCount }, (_, i) => ({\n        id: `transfer-${index}-${i}`,\n        label: `Transfer ${i + 1}`,\n        type: 'transfer' as const,\n        status: 'pending' as const,\n      }));\n\n      return {\n        id: `worker-${index}`,\n        label: `Worker ${index + 1}`,\n        type: 'worker' as const,\n        children: transfers,\n        status: 'pending' as const,\n      };\n    });\n\n    return {\n      id: 'orchestrator',\n      label: 'Orchestrator',\n      type: 'orchestrator' as const,\n      children: workers,\n      status: 'pending' as const,\n    };\n  };\n\n  const tree = buildTree();\n  const totalNodes = 1 + batches.length + batches.reduce((sum, b) => sum + b.recipientCount, 0);\n\n  // Map transaction state to target progress ranges\n  const getTargetProgressForState = useCallback((state: TransactionState): { min: number; max: number } => {\n    switch (state) {\n      case 'preparing':\n        return { min: 0, max: 0.30 }; // 0-30%\n      case 'signing':\n        return { min: 0.30, max: 0.50 }; // 30-50%\n      case 'submitting':\n        return { min: 0.50, max: 0.85 }; // 50-85%\n      case 'success':\n        return { min: 0.85, max: 1.0 }; // 85-100%\n      default:\n        return { min: 0, max: 0 };\n    }\n  }, []);\n\n  // Animate within a phase - smoothly animate toward the phase's max progress\n  const animateWithinPhase = useCallback(() => {\n    if (!phaseStartTimeRef.current) return;\n\n    const elapsed = Date.now() - phaseStartTimeRef.current;\n    const target = getTargetProgressForState(transactionState);\n\n    // Animate toward the max of current phase over MIN_PHASE_DURATION_MS\n    // But cap at 90% of the phase max to leave room for next phase transition\n    const phaseProgress = Math.min(elapsed / MIN_PHASE_DURATION_MS, 1);\n    const cappedMax = target.min + (target.max - target.min) * 0.9;\n    const newProgress = target.min + (cappedMax - target.min) * easeOutCubic(phaseProgress);\n\n    setAnimationProgress(prev => Math.max(prev, newProgress));\n\n    // Update visual phase\n    if (newProgress < 0.30) {\n      setCurrentPhase('building');\n    } else if (newProgress < 0.50) {\n      setCurrentPhase('signing');\n    } else if (newProgress < 0.85) {\n      setCurrentPhase('submitting');\n    }\n\n    // Keep animating if we haven't reached the cap and transaction is still in this phase\n    if (phaseProgress < 1 && !isComplete) {\n      animationRef.current = requestAnimationFrame(animateWithinPhase);\n    }\n  }, [transactionState, isComplete, getTargetProgressForState]);\n\n  // Completion animation - smoothly animate from current progress to 100%\n  const animateToCompletion = useCallback(() => {\n    if (!completionStartTimeRef.current) return;\n\n    const elapsed = Date.now() - completionStartTimeRef.current;\n    const progress = Math.min(elapsed / COMPLETION_ANIMATION_MS, 1);\n\n    // Ease out from current progress to 100%\n    const startProgress = progressAtCompletionRef.current;\n    const newProgress = startProgress + (1 - startProgress) * easeOutCubic(progress);\n\n    setAnimationProgress(newProgress);\n\n    // Update visual phase based on progress\n    if (newProgress < 0.95) {\n      setCurrentPhase('submitting');\n    } else {\n      setCurrentPhase('complete');\n    }\n\n    if (progress < 1) {\n      animationRef.current = requestAnimationFrame(animateToCompletion);\n    } else {\n      // Animation fully complete\n      setIsVisualizationComplete(true);\n      onVisualizationComplete?.();\n    }\n  }, [onVisualizationComplete]);\n\n  // Handle transaction state changes\n  useEffect(() => {\n    // Cancel any existing animation\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n      animationRef.current = null;\n    }\n\n    // Handle state transitions\n    if (transactionState !== lastPhaseRef.current) {\n      lastPhaseRef.current = transactionState;\n\n      if (transactionState === 'preparing') {\n        // Start fresh\n        phaseStartTimeRef.current = Date.now();\n        setCurrentPhase('building');\n        animationRef.current = requestAnimationFrame(animateWithinPhase);\n      } else if (transactionState === 'signing') {\n        phaseStartTimeRef.current = Date.now();\n        setCurrentPhase('signing');\n        // Jump to signing min if we're behind\n        setAnimationProgress(prev => Math.max(prev, 0.30));\n        animationRef.current = requestAnimationFrame(animateWithinPhase);\n      } else if (transactionState === 'submitting') {\n        phaseStartTimeRef.current = Date.now();\n        setCurrentPhase('submitting');\n        // Jump to submitting min if we're behind\n        setAnimationProgress(prev => Math.max(prev, 0.50));\n        animationRef.current = requestAnimationFrame(animateWithinPhase);\n      } else if (transactionState === 'success') {\n        // Transaction complete! Start completion animation\n        progressAtCompletionRef.current = animationProgress;\n        completionStartTimeRef.current = Date.now();\n        animationRef.current = requestAnimationFrame(animateToCompletion);\n      } else if (transactionState === 'error') {\n        // Stop animation on error\n        setCurrentPhase('idle');\n      } else if (transactionState === 'idle') {\n        // Reset everything\n        phaseStartTimeRef.current = null;\n        completionStartTimeRef.current = null;\n        progressAtCompletionRef.current = 0;\n        setAnimationProgress(0);\n        setCurrentPhase('idle');\n        setIsVisualizationComplete(false);\n      }\n    }\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, [transactionState, animateWithinPhase, animateToCompletion, animationProgress]);\n\n  // Fallback: Handle isComplete prop if transactionState isn't being passed\n  useEffect(() => {\n    if (isComplete && transactionState !== 'success' && !completionStartTimeRef.current) {\n      // Fallback for legacy usage without transactionState\n      progressAtCompletionRef.current = animationProgress;\n      completionStartTimeRef.current = Date.now();\n      animationRef.current = requestAnimationFrame(animateToCompletion);\n    }\n  }, [isComplete, transactionState, animationProgress, animateToCompletion]);\n\n  // Reset on new processing (when idle and not complete)\n  useEffect(() => {\n    if (!isProcessing && !isComplete && transactionState === 'idle') {\n      phaseStartTimeRef.current = null;\n      completionStartTimeRef.current = null;\n      progressAtCompletionRef.current = 0;\n      setAnimationProgress(0);\n      setCurrentPhase('idle');\n      setIsVisualizationComplete(false);\n    }\n  }, [isProcessing, isComplete, transactionState]);\n\n  // Calculate node status based on progress\n  const getNodeStatus = (_nodeIndex: number, totalBeforeNode: number): 'pending' | 'active' | 'complete' => {\n    // If visualization is complete, all nodes are complete\n    if (isVisualizationComplete || animationProgress >= 0.99) {\n      return 'complete';\n    }\n\n    const nodeProgress = totalBeforeNode / totalNodes;\n    if (animationProgress >= nodeProgress + (1 / totalNodes)) {\n      return 'complete';\n    } else if (animationProgress >= nodeProgress) {\n      return 'active';\n    }\n    return 'pending';\n  };\n\n  const phaseLabels = {\n    idle: 'Ready to process',\n    building: 'Building Authorization Tree...',\n    signing: 'Awaiting Signature...',\n    submitting: 'Submitting Transaction...',\n    complete: 'Transaction Complete',\n  };\n\n  return (\n    <div className=\"bg-black/40 backdrop-blur-lg rounded-2xl border border-white/5 p-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"text-lg font-semibold text-white\">Authorization Tree</h3>\n        <div className=\"flex items-center gap-2\">\n          {currentPhase !== 'idle' && currentPhase !== 'complete' && (\n            <div className=\"w-2 h-2 rounded-full bg-blue-500 animate-pulse\" />\n          )}\n          {currentPhase === 'complete' && (\n            <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n          )}\n          <span className=\"text-sm text-white/60\">{phaseLabels[currentPhase]}</span>\n        </div>\n      </div>\n\n      {/* Progress Bar */}\n      {currentPhase !== 'idle' && (\n        <div className=\"mb-6\">\n          <div className=\"h-1 bg-white/10 rounded-full overflow-hidden\">\n            <div\n              className=\"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 ease-out\"\n              style={{ width: `${animationProgress * 100}%` }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Tree Visualization */}\n      <div className=\"relative\">\n        {/* Orchestrator Level */}\n        <div className=\"flex flex-col items-center\">\n          <TreeNode\n            label=\"Orchestrator\"\n            sublabel=\"orchestrate_payments()\"\n            status={getNodeStatus(0, 1)}\n            isRoot\n          />\n\n          {/* Connection Lines */}\n          {batches.length > 0 && (\n            <div className=\"relative w-full mt-4 mb-4\">\n              <div className=\"absolute left-1/2 transform -translate-x-1/2 w-px h-6 bg-white/20\" />\n              <div className=\"absolute top-6 left-1/2 transform -translate-x-1/2 w-[80%] h-px bg-white/20\" />\n            </div>\n          )}\n\n          {/* Worker Level */}\n          <div className=\"flex flex-wrap justify-center gap-4 w-full\">\n            {batches.map((batch, workerIndex) => {\n              const nodesBeforeWorker = 1 + workerIndex * (1 + Math.max(...batches.map(b => b.recipientCount)));\n              const workerStatus = getNodeStatus(workerIndex + 1, nodesBeforeWorker / totalNodes);\n\n              return (\n                <div key={workerIndex} className=\"flex flex-col items-center\">\n                  {/* Vertical line from horizontal connector */}\n                  <div className=\"w-px h-4 bg-white/20\" />\n\n                  <TreeNode\n                    label={`Worker ${workerIndex + 1}`}\n                    sublabel={`batch_pay() - ${batch.recipientCount} transfers`}\n                    status={workerStatus}\n                  />\n\n                  {/* Transfer indicators */}\n                  <div className=\"mt-3 flex flex-wrap justify-center gap-1 max-w-[120px]\">\n                    {Array.from({ length: batch.recipientCount }, (_, i) => {\n                      const transferNodeIndex = nodesBeforeWorker + 1 + i;\n                      const transferStatus = getNodeStatus(transferNodeIndex, transferNodeIndex / totalNodes);\n                      return (\n                        <div\n                          key={i}\n                          className={`w-2 h-2 rounded-full transition-all duration-300 ${\n                            transferStatus === 'complete'\n                              ? 'bg-green-500'\n                              : transferStatus === 'active'\n                              ? 'bg-blue-500 animate-pulse'\n                              : 'bg-white/20'\n                          }`}\n                          title={`Transfer ${i + 1}`}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Stats */}\n      <div className=\"mt-6 pt-6 border-t border-white/10 grid grid-cols-3 gap-4 text-center\">\n        <div>\n          <div className=\"text-2xl font-semibold text-white\">{batches.length}</div>\n          <div className=\"text-xs text-white/40\">Batches</div>\n        </div>\n        <div>\n          <div className=\"text-2xl font-semibold text-white\">\n            {batches.reduce((sum, b) => sum + b.recipientCount, 0)}\n          </div>\n          <div className=\"text-xs text-white/40\">Recipients</div>\n        </div>\n        <div>\n          <div className=\"text-2xl font-semibold text-white\">1</div>\n          <div className=\"text-xs text-white/40\">Signature</div>\n        </div>\n      </div>\n\n      {/* Transaction Hash */}\n      {transactionHash && currentPhase === 'complete' && (\n        <div className=\"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg\">\n          <div className=\"text-xs text-green-400 mb-1\">Transaction Hash</div>\n          <div className=\"text-sm text-white font-mono truncate\">\n            <a\n              href={`https://stellar.expert/explorer/testnet/tx/${transactionHash}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"hover:text-blue-400 transition-colors\"\n            >\n              {transactionHash}\n            </a>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface TreeNodeProps {\n  label: string;\n  sublabel?: string;\n  status: 'pending' | 'active' | 'complete';\n  isRoot?: boolean;\n}\n\nfunction TreeNode({ label, sublabel, status, isRoot }: TreeNodeProps) {\n  const statusStyles = {\n    pending: 'border-white/20 bg-black/40',\n    active: 'border-blue-500 bg-blue-500/10 shadow-lg shadow-blue-500/20',\n    complete: 'border-green-500 bg-green-500/10',\n  };\n\n  const iconStyles = {\n    pending: 'text-white/40',\n    active: 'text-blue-400',\n    complete: 'text-green-400',\n  };\n\n  return (\n    <div\n      className={`relative px-4 py-3 rounded-xl border transition-all duration-300 ${statusStyles[status]} ${\n        isRoot ? 'min-w-[200px]' : 'min-w-[140px]'\n      }`}\n    >\n      <div className=\"flex items-center gap-2\">\n        {/* Status Icon */}\n        <div className={`transition-colors duration-300 ${iconStyles[status]}`}>\n          {status === 'complete' ? (\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n            </svg>\n          ) : status === 'active' ? (\n            <svg className=\"w-4 h-4 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n            </svg>\n          ) : (\n            <div className=\"w-4 h-4 rounded-full border border-current\" />\n          )}\n        </div>\n\n        <div>\n          <div className=\"text-sm font-medium text-white\">{label}</div>\n          {sublabel && (\n            <div className=\"text-xs text-white/40 font-mono\">{sublabel}</div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}